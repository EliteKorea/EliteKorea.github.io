<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê³µë¶€ RPG í”Œë˜ë„ˆ</title>
<style>
body{margin:0;font-family:Arial;background:#f5f5f5}
.hidden{display:none}
.center{display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#fff;border-radius:12px;padding:20px;width:320px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
button{padding:6px 10px;margin:4px;cursor:pointer}
/* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
#mainLayout{display:grid;grid-template-columns:180px 1fr;height:100vh}
#left{background:#222;color:#fff;padding:10px}
#right{padding:10px;overflow:auto}
/* ë‹¬ë ¥ */
#calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
.day{border:1px solid #aaa;min-height:60px;padding:4px;font-size:12px}
.today{border:2px solid red}
/* íƒ€ì´ë¨¸ */
#timer{width:140px;height:140px;border-radius:50%;border:6px solid #333;display:flex;align-items:center;justify-content:center;margin:10px 0}
</style>
</head>
<body>

<!-- ë¡œê·¸ì¸ -->
<div id="loginPage" class="center">
  <div class="box">
    <h2>ë¡œê·¸ì¸</h2>
    <input id="user" placeholder="ë‹‰ë„¤ì„"><br><br>
    <button onclick="login()">ì…ì¥</button>
  </div>
</div>

<!-- ë©”ì¸ -->
<div id="mainPage" class="hidden">
  <div id="mainLayout">
    <div id="left">
      <h3>ğŸ“Œ ë©”ë‰´</h3>
      <button onclick="showPage('home')">ë©”ì¸</button><br>
      <button onclick="showPage('study')">ê³µë¶€ ì¼ì •</button><br><br>
      <div>
        â­ Lv <span id="level">1</span><br>
        ğŸ· <span id="title"></span><br>
        ğŸ’ P <span id="point">0</span>
      </div>
    </div>
    <div id="right">

      <!-- í™ˆ -->
      <div id="home">
        <h2>ì˜¤ëŠ˜ì˜ ëª…ì–¸</h2>
        <p id="quote"></p>
        <button onclick="checkIn()">ğŸ“… ì¶œì„ ì²´í¬</button>
        <h3>ì¶œì„ ë‹¬ë ¥</h3>
        <div id="stampCalendar"></div>
      </div>

      <!-- ê³µë¶€ ì¼ì • -->
      <div id="study" class="hidden">
        <h2 id="dateTitle"></h2>
        <div style="display:flex;gap:20px">
          <div>
            <div id="timer">00:00</div>
            <input id="h" type="number" placeholder="ì‹œ" min="0">
            <input id="m" type="number" placeholder="ë¶„" min="0">
            <input id="s" type="number" placeholder="ì´ˆ" min="0">
            <br>
            <button onclick="startTimer()">ì‹œì‘</button>
          </div>
          <div style="flex:1">
            <div id="calendar"></div>
          </div>
        </div>
        <h3>íƒ€ì´ë¨¸ ìŠ¤í‚¨</h3>
        <button onclick="buySkin('default',0)">ê¸°ë³¸</button>
        <button onclick="buySkin('red',10)">ë ˆë“œ</button>
        <button onclick="buySkin('pixel',20)">í”½ì…€</button>
      </div>

    </div>
  </div>
</div>

<script>
/* ë¡œê·¸ì¸ */
function login(){
  const u=document.getElementById('user').value;
  if(!u) return alert('ë‹‰ë„¤ì„ ì…ë ¥');
  localStorage.setItem('user',u);
  loginPage.classList.add('hidden');
  mainPage.classList.remove('hidden');
}

/* í˜ì´ì§€ */
function showPage(p){
  home.classList.add('hidden');
  study.classList.add('hidden');
  document.getElementById(p).classList.remove('hidden');
}

/* í¬ì¸íŠ¸ & ë ˆë²¨ */
function calcLevel(p){return p>=100?5:p>=50?4:p>=25?3:p>=10?2:1}
function titleByLv(lv){return ['ğŸŒ± ì´ˆë³´','ğŸ”¥ ì§‘ì¤‘ëŸ¬','âš¡ ê¾¸ì¤€ëŸ¬','ğŸ§  ë§ˆìŠ¤í„°','ğŸ‘‘ ì „ì„¤'][lv-1]}
function updateStatus(){
  const p=Number(localStorage.getItem('point')||0);
  point.innerText=p;
  const lv=calcLevel(p);
  level.innerText=lv;
  title.innerText=titleByLv(lv);
}

/* ì¶œì„ */
function checkIn(){
  const d=new Date().toISOString().slice(0,10);
  let data=JSON.parse(localStorage.getItem('att')||'{}');
  if(data[d]) return alert('ì´ë¯¸ ì¶œì„');
  let streak=Number(localStorage.getItem('streak')||0)+1;
  let p=Number(localStorage.getItem('point')||0);
  if(streak===7){p+=10;streak=0;} else p+=1;
  data[d]='âœ”';
  localStorage.setItem('att',JSON.stringify(data));
  localStorage.setItem('streak',streak);
  localStorage.setItem('point',p);
  drawStamp();updateStatus();
}
function drawStamp(){
  let data=JSON.parse(localStorage.getItem('att')||'{}');
  let html='';
  for(let i=1;i<=31;i++) html+=`<span style="margin:2px">${Object.values(data)[i-1]||'â–¡'}</span>`;
  stampCalendar.innerHTML=html;
}

/* ëª…ì–¸ */
const quotes=['ì˜¤ëŠ˜ì˜ ë…¸ë ¥ì´ ë‚´ì¼ì„ ë§Œë“ ë‹¤','ê¾¸ì¤€í•¨ì´ ì¬ëŠ¥ì´ë‹¤','í¬ê¸°í•˜ì§€ ë§ì'];
quote.innerText=quotes[Math.floor(Math.random()*quotes.length)];

/* ë‹¬ë ¥ ë©”ëª¨ */
function drawCalendar(){
  calendar.innerHTML='';
  const now=new Date();
  dateTitle.innerText=`${now.getFullYear()}ë…„ ${now.getMonth()+1}ì›” ${now.getDate()}ì¼`;
  for(let i=1;i<=31;i++){
    const d=document.createElement('div');
    d.className='day';
    if(i===now.getDate()) d.classList.add('today');
    const key=`memo-${now.getMonth()}-${i}`;
    d.contentEditable=true;
    d.innerText=localStorage.getItem(key)||i;
    d.onblur=()=>localStorage.setItem(key,d.innerText);
    calendar.appendChild(d);
  }
}

/* íƒ€ì´ë¨¸ */
let timerInt;
function startTimer(){
  let t=(+h.value||0)*3600+(+m.value||0)*60+(+s.value||0);
  clearInterval(timerInt);
  timerInt=setInterval(()=>{
    if(t<=0){clearInterval(timerInt);return;}
    t--;
    timer.innerText=Math.floor(t/60)+":"+(t%60).toString().padStart(2,'0');
  },1000);
}

/* íƒ€ì´ë¨¸ ìŠ¤í‚¨ */
function buySkin(s,p){
  let pt=Number(localStorage.getItem('point')||0);
  if(pt<p) return alert('í¬ì¸íŠ¸ ë¶€ì¡±');
  localStorage.setItem('point',pt-p);
  localStorage.setItem('skin',s);
  applySkin();updateStatus();
}
function applySkin(){
  const s=localStorage.getItem('skin');
  if(s==='red') timer.style.borderColor='red';
  else if(s==='pixel'){timer.style.borderColor='#0f0';timer.style.background='#000';timer.style.color='#0f0';}
}

/* ì´ˆê¸° */
if(localStorage.getItem('user')){loginPage.classList.add('hidden');mainPage.classList.remove('hidden');}
drawCalendar();drawStamp();updateStatus();applySkin();
</script>
</body>
</html>

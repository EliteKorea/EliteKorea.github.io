<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê³µë¶€ ì¼ì •</title>
<style>
*{box-sizing:border-box;}
body{margin:0;height:100vh;font-family:Arial;display:flex;overflow:hidden;background:#f2f2f2;}
body.dark{background:#222;color:white;}
.app{display:flex;height:100vh;width:100vw;}
.left{width:260px;padding:15px;background:#fff;transition:width 0.3s;}
body.dark .left{background:#333;}
.menu-header{font-weight:bold;font-size:18px;cursor:pointer;margin-bottom:15px;}
.menu-btn{display:flex;align-items:center;width:100%;padding:10px;margin-bottom:8px;background:#eee;border:none;cursor:pointer;justify-content:center;}
.menu-btn:hover{background:#ddd;}
.left.closed{width:60px;}
.left.closed .menu-btn span:nth-child(2){display:none;}
.right{flex:1;padding:15px;display:flex;flex-direction:column;}
canvas{position:fixed;top:0;left:0;z-index:-1;}

/* íŒ¨ë„ */
.panel{
  display:none;
  overflow:hidden;
  padding:10px;
  margin-bottom:5px;
  border-radius:6px;
  background:#f5f5f5;
  transition: all 0.3s ease;
}
body.dark .panel{background:#444;color:white;}

/* íƒ€ì´ë¨¸ */
.timer-container{position:relative;width:200px;height:200px;margin:auto;}
.timer-container svg{width:200px;height:200px;}
.timer-container circle{fill:none;stroke-width:12;}
.timer-container .bg{stroke:#ddd;}
.timer-container .progress{stroke:#4caf50;stroke-linecap:round;transform:rotate(-90deg);transform-origin:50% 50%;stroke-dasharray:565;stroke-dashoffset:0;}
.timer-container #time{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:28px;font-weight:bold;text-align:center;}

/* ë‹¬ë ¥ */
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:10px;}
.day{background:#fff;padding:5px;border-radius:6px;font-size:12px;cursor:pointer;}
body.dark .day{background:#444;}
.day textarea{width:100%;height:70px;resize:none;}
.top{display:flex;justify-content:space-between;align-items:center;}
button{cursor:pointer;}
#quote{margin-bottom:10px;font-style:italic;}
</style>
</head>
<body>

<canvas id="snow"></canvas>

<div class="app">
  <!-- ì™¼ìª½ ë©”ë‰´ -->
  <div class="left" id="leftMenu">
    <div class="menu-header" onclick="toggleMenu()">â˜° ë©”ë‰´</div>
    
    <!-- ë©”ë‰´ ë²„íŠ¼ -->
    <button class="menu-btn" onclick="togglePanel('timerPanel', this)"><span>â±</span> <span>íƒ€ì´ë¨¸</span></button>
    <button class="menu-btn" onclick="togglePanel('checkPanel', this)"><span>ğŸ“Œ</span> <span>ì¶œì„</span></button>
    <button class="menu-btn" onclick="togglePanel('memoPanel', this)"><span>ğŸ“</span> <span>ë©”ëª¨</span></button>

    <!-- íƒ€ì´ë¨¸ íŒ¨ë„ -->
    <div class="panel" id="timerPanel">
      <div class="timer-container">
        <svg>
          <circle class="bg" cx="100" cy="100" r="90"/>
          <circle class="progress" cx="100" cy="100" r="90" id="circle"/>
        </svg>
        <div id="time">00:00:00</div>
      </div>
      <input id="h" placeholder="ì‹œ" size="2">
      <input id="m" placeholder="ë¶„" size="2">
      <input id="s" placeholder="ì´ˆ" size="2"><br>
      <button onclick="start()">ì‹œì‘</button>
      <button onclick="pause()">ì •ì§€</button>
      <button onclick="reset()">ì´ˆê¸°í™”</button>
    </div>

    <!-- ì¶œì„ íŒ¨ë„ -->
    <div class="panel" id="checkPanel">
      <button onclick="check()">ğŸ“… ì¶œì„ì²´í¬</button>
      <div id="point">í¬ì¸íŠ¸: 0</div>
    </div>

    <!-- ë©”ëª¨ íŒ¨ë„ -->
    <div class="panel" id="memoPanel">
      <p>ì•„ë˜ ë‹¬ë ¥ì— ë©”ëª¨ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
  </div>

  <!-- ì˜¤ë¥¸ìª½ -->
  <div class="right">
    <div id="quote">â€œì˜¤ëŠ˜ì˜ ëª…ì–¸: ì‘ì€ ìŠµê´€ì´ í° ë³€í™”ë¥¼ ë§Œë“ ë‹¤.â€</div>
    <div class="top">
      <h2 id="dateDisplay"></h2>
      <button onclick="mode()">ğŸŒ™/â˜€ï¸</button>
    </div>
    <div class="calendar" id="cal"></div>
  </div>
</div>

<script>
/* ===== ë©”ë‰´ í† ê¸€ ===== */
let menuOpen=true;
function toggleMenu(){
  menuOpen=!menuOpen;
  document.getElementById("leftMenu").classList.toggle("closed",!menuOpen);
}

/* ===== íŒ¨ë„ í† ê¸€ ê¸°ëŠ¥ ===== */
function togglePanel(id, btn){
  const panel=document.getElementById(id);
  if(panel.style.display==='block'){ // ì´ë¯¸ ì—´ë ¤ìˆìœ¼ë©´ ë‹«ê¸°
    panel.style.display='none';
  } else { // ë‹«í˜€ìˆìœ¼ë©´ ì—´ê¸°
    // ë‹¤ë¥¸ íŒ¨ë„ ëª¨ë‘ ë‹«ê¸°
    document.querySelectorAll('.panel').forEach(p=>{
      p.style.display='none';
    });
    // ì„ íƒëœ íŒ¨ë„ ë²„íŠ¼ ë°”ë¡œ ì•„ë˜ì— ë°°ì¹˜ í›„ í‘œì‹œ
    btn.insertAdjacentElement('afterend', panel);
    panel.style.display='block';
  }
}

/* ===== ë‹¤í¬ ëª¨ë“œ ===== */
function mode(){document.body.classList.toggle("dark");}

/* ===== ì›í˜• íƒ€ì´ë¨¸ ===== */
let t=0,r=0,i=null;
const c=document.getElementById("circle"),max=565;
function draw(){
  let h=Math.floor(r/3600),
      m=Math.floor((r%3600)/60),
      s=r%60;
  time.innerText=`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  c.style.strokeDashoffset=max-(r/t)*max;
}
function start(){
  if(i) return;
  if(!r){
    t=r=(+h.value||0)*3600+(+m.value||0)*60+(+s.value||0);
    if(!r) return;
  }
  i=setInterval(()=>{r--;draw();if(r<=0)clearInterval(i)},1000);
}
function pause(){clearInterval(i);i=null;}
function reset(){pause();r=0;time.innerText="00:00:00";c.style.strokeDashoffset=0;}

/* ===== ë‹¬ë ¥ ===== */
const now=new Date();
dateDisplay.innerText=`ì˜¤ëŠ˜: ${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}`;
const cal=document.getElementById("cal");
for(let d=1;d<=30;d++){
  const box=document.createElement("div");
  box.className="day";
  const ta=document.createElement("textarea");
  ta.value=localStorage["d"+d]||"";
  ta.oninput=()=>localStorage["d"+d]=ta.value;
  // í´ë¦­í•˜ë©´ ë©”ëª¨ íŒ¨ë„ í† ê¸€
  box.onclick=()=>{
    const memoBtn=document.querySelector('.menu-btn:nth-child(3)');
    togglePanel('memoPanel', memoBtn);
  }
  box.innerHTML=`<b>${d}</b>`;
  box.appendChild(ta);
  cal.appendChild(box);
}

/* ===== ì¶œì„ ì²´í¬ ===== */
let p=+localStorage.point||0;
point.innerText="í¬ì¸íŠ¸: "+p;
function check(){
  const today=new Date().toDateString();
  if(localStorage.last!==today){
    p+= (localStorage.streak==6)?10:1;
    localStorage.streak=(+localStorage.streak||0)+1;
    localStorage.last=today;
    localStorage.point=p;
    point.innerText="í¬ì¸íŠ¸: "+p;
  }
}

/* ===== ëˆˆ ===== */
const cv=snow,ctx=cv.getContext("2d");
cv.width=innerWidth;cv.height=innerHeight;
let fl=[];
for(let i=0;i<100;i++) fl.push({x:Math.random()*cv.width,y:Math.random()*cv.height,r:Math.random()*3+1});
setInterval(()=>{
  ctx.clearRect(0,0,cv.width,cv.height);
  ctx.fillStyle="white";
  fl.forEach(f=>{
    ctx.beginPath();
    ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
    ctx.fill();
    f.y+=1;if(f.y>cv.height)f.y=0;
  });
},30);
</script>

</body>
</html>

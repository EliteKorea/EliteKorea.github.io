<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê³µë¶€ í”Œë˜ë„ˆ</title>

<style>
body{
  margin:0;
  background:#cfe2ff;
  font-family:êµ´ë¦¼;
}
.hidden{display:none;}
.center{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.box{
  width:420px;
  background:#fff;
  border:4px solid #6b8cff;
  padding:20px;
}
button,input{
  padding:6px;
  margin:4px;
}
h2{text-align:center}

.menu button{
  width:100%;
  margin-top:8px;
}

.study-wrap{
  display:flex;
  gap:10px;
}
.timer{
  width:160px;
  text-align:center;
}
.circle{
  width:140px;
  height:140px;
  border-radius:50%;
  border:8px solid #6b8cff;
  display:flex;
  align-items:center;
  justify-content:center;
  margin:auto;
}
.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:4px;
}
.cell{
  height:90px;
  border:2px solid #8aa4ff;
}
.today{border:3px solid hotpink;}
textarea{
  width:100%;
  height:100%;
  border:none;
  resize:none;
}
</style>
</head>

<body>

<!-- ë¡œê·¸ì¸ -->
<div id="loginPage" class="center">
  <div class="box">
    <h2>ë¡œê·¸ì¸ / íšŒì›ê°€ì…</h2>

    <input id="lid" placeholder="ì•„ì´ë””">
    <input id="lpw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button onclick="doLogin()">ë¡œê·¸ì¸</button>

    <hr>

    <input id="sid" placeholder="ì•„ì´ë””">
    <input id="spw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button onclick="signup()">íšŒì›ê°€ì…</button>
  </div>
</div>

<!-- ë©”ì¸ -->
<div id="mainPage" class="center hidden">
  <div class="box">
    <h2 id="welcome"></h2>
    <p id="quote"></p>
    <div class="menu">
      <button onclick="openStudy()">ğŸ“… ê³µë¶€ ì¼ì •</button>
      <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>
</div>

<!-- ê³µë¶€ ì¼ì • -->
<div id="studyPage" class="center hidden">
  <div class="box" style="width:720px">
    <button onclick="backMain()">â¬… ë©”ì¸</button>
    <h2 id="title"></h2>

    <div class="study-wrap">
      <div class="timer">
        <input id="h" type="number" value="1" style="width:40px">ì‹œ
        <input id="m" type="number" value="0" style="width:40px">ë¶„
        <input id="s" type="number" value="0" style="width:40px">ì´ˆ
        <br>
        <button onclick="start()">ì‹œì‘</button>
        <button onclick="stop()">ì •ì§€</button>
        <div class="circle" id="time">00:00:00</div>
      </div>

      <div style="flex:1">
        <div class="calendar" id="cal"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* ëª…ì–¸ */
const quotes=[
  "ì˜¤ëŠ˜ì˜ ë…¸ë ¥ì´ ë‚´ì¼ì„ ë§Œë“ ë‹¤",
  "ì¡°ê¸ˆì”© í•´ë„ ë©ˆì¶”ì§€ ë§ì",
  "ê³µë¶€ëŠ” ë°°ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤"
];
quote.innerText=quotes[Math.floor(Math.random()*quotes.length)];

/* íšŒì›ê°€ì… */
function signup(){
  const id=sid.value, pw=spw.value;
  if(!id||!pw){alert("ì…ë ¥í•´");return;}
  let users=JSON.parse(localStorage.getItem("users"))||{};
  if(users[id]){alert("ì´ë¯¸ ìˆìŒ");return;}
  users[id]=pw;
  localStorage.setItem("users",JSON.stringify(users));
  alert("íšŒì›ê°€ì… ì™„ë£Œ");
}

/* ë¡œê·¸ì¸ (ë²„ê·¸ ì—†ìŒ) */
function doLogin(){
  const id=lid.value, pw=lpw.value;
  let users=JSON.parse(localStorage.getItem("users"))||{};
  if(users[id]===pw){
    localStorage.setItem("loginUser",id);
    showMain();
  }else{
    alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼");
  }
}

function logout(){
  localStorage.removeItem("loginUser");
  location.reload();
}

/* í™”ë©´ ì´ë™ */
function showMain(){
  loginPage.classList.add("hidden");
  mainPage.classList.remove("hidden");
  welcome.innerText=localStorage.getItem("loginUser")+"ë‹˜ í™˜ì˜!";
}
function openStudy(){
  mainPage.classList.add("hidden");
  studyPage.classList.remove("hidden");
  drawCalendar();
}
function backMain(){
  studyPage.classList.add("hidden");
  mainPage.classList.remove("hidden");
}

/* ìë™ ë¡œê·¸ì¸ */
if(localStorage.getItem("loginUser")){
  showMain();
}

/* íƒ€ì´ë¨¸ */
let timer=null, remain=0;
function start(){
  stop();
  remain=Number(h.value)*3600+Number(m.value)*60+Number(s.value);
  timer=setInterval(()=>{
    if(remain<=0){stop();return;}
    remain--;
    time.innerText=
      String(Math.floor(remain/3600)).padStart(2,"0")+":"+
      String(Math.floor(remain%3600/60)).padStart(2,"0")+":"+
      String(remain%60).padStart(2,"0");
  },1000);
}
function stop(){clearInterval(timer);}

/* ë‹¬ë ¥ */
let memos=JSON.parse(localStorage.getItem("memos"))||{};
function drawCalendar(){
  cal.innerHTML="";
  const now=new Date();
  const y=now.getFullYear(), m=now.getMonth(), d=now.getDate();
  title.innerText=`${y}ë…„ ${m+1}ì›” ${d}ì¼`;
  const first=new Date(y,m,1).getDay();
  const last=new Date(y,m+1,0).getDate();

  for(let i=0;i<first;i++) cal.appendChild(document.createElement("div"));
  for(let i=1;i<=last;i++){
    const key=`${localStorage.getItem("loginUser")}_${y}-${m+1}-${i}`;
    const cell=document.createElement("div");
    cell.className="cell"+(i===d?" today":"");
    const ta=document.createElement("textarea");
    ta.value=memos[key]||"";
    ta.oninput=()=>{
      memos[key]=ta.value;
      localStorage.setItem("memos",JSON.stringify(memos));
    };
    cell.appendChild(ta);
    cal.appendChild(cell);
  }
}
</script>

</body>
</html>

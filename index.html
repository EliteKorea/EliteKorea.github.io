<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>κ³µλ¶€ μΌμ •</title>

<style>
*{box-sizing:border-box;}
body{
  margin:0;
  height:100vh;
  display:flex;
  background:#f2f2f2;
  font-family:Arial;
  overflow:hidden;
}
body.dark{background:#222;color:white;}

.left{
  width:260px;
  padding:15px;
  background:#fff;
}
body.dark .left{background:#333;}

.right{
  flex:1;
  padding:15px;
  display:flex;
  flex-direction:column;
}

/* λ λ°°κ²½ */
canvas{
  position:fixed;
  top:0;left:0;
  z-index:-1;
}

/* νƒ€μ΄λ¨Έ */
.timer{
  text-align:center;
}
svg{width:180px;height:180px;}
circle{fill:none;stroke-width:10;}
.bg{stroke:#ddd;}
.progress{
  stroke:#4caf50;
  stroke-linecap:round;
  transform:rotate(-90deg);
  transform-origin:50% 50%;
  stroke-dasharray:565;
}

/* λ‹¬λ ¥ */
.calendar{
  flex:1;
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:5px;
  margin-top:10px;
}
.day{
  background:#fff;
  padding:5px;
  border-radius:6px;
  font-size:12px;
}
body.dark .day{background:#444;}
.day textarea{
  width:100%;
  height:70px;
  resize:none;
}

/* μƒλ‹¨ */
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
button{cursor:pointer;}
</style>
</head>

<body>

<canvas id="snow"></canvas>

<div class="left">
  <div class="timer">
    <h3>β± νƒ€μ΄λ¨Έ</h3>
    <svg>
      <circle class="bg" cx="90" cy="90" r="80"/>
      <circle class="progress" cx="90" cy="90" r="80" id="circle"/>
    </svg>
    <div id="time">00:00:00</div>
    <input id="h" placeholder="μ‹" size="2">
    <input id="m" placeholder="λ¶„" size="2">
    <input id="s" placeholder="μ΄" size="2"><br>
    <button onclick="start()">μ‹μ‘</button>
    <button onclick="pause()">μ •μ§€</button>
    <button onclick="reset()">μ΄κΈ°ν™”</button>
  </div>

  <hr>
  <button onclick="check()">π“… μ¶μ„μ²΄ν¬</button>
  <div id="point">ν¬μΈνΈ: 0</div>
</div>

<div class="right">
  <div class="top">
    <h2 id="title"></h2>
    <button onclick="mode()">π™/β€οΈ</button>
  </div>

  <div class="calendar" id="cal"></div>
</div>

<script>
/* ===== νƒ€μ΄λ¨Έ ===== */
let t=0,r=0,i=null;
const c=document.getElementById("circle"),max=565;
function draw(){
  let h=Math.floor(r/3600),
      m=Math.floor((r%3600)/60),
      s=r%60;
  time.innerText=
    `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  c.style.strokeDashoffset=max-(r/t)*max;
}
function start(){
  if(i) return;
  if(!r){
    t=r=(+h.value||0)*3600+(+m.value||0)*60+(+s.value||0);
    if(!r) return;
  }
  i=setInterval(()=>{r--;draw();if(r<=0)clearInterval(i)},1000);
}
function pause(){clearInterval(i);i=null;}
function reset(){pause();r=0;time.innerText="00:00:00";c.style.strokeDashoffset=0;}

/* ===== λ‹¬λ ¥ ===== */
const now=new Date();
title.innerText=`${now.getFullYear()}λ…„ ${now.getMonth()+1}μ›”`;
const cal=document.getElementById("cal");
for(let d=1;d<=30;d++){
  const box=document.createElement("div");
  box.className="day";
  const ta=document.createElement("textarea");
  ta.value=localStorage["d"+d]||"";
  ta.oninput=()=>localStorage["d"+d]=ta.value;
  box.innerHTML=`<b>${d}</b>`;
  box.appendChild(ta);
  cal.appendChild(box);
}

/* ===== μ¶μ„ ===== */
let p=+localStorage.point||0;
point.innerText="ν¬μΈνΈ: "+p;
function check(){
  const today=new Date().toDateString();
  if(localStorage.last!==today){
    p+= (localStorage.streak==6)?10:1;
    localStorage.streak=(+localStorage.streak||0)+1;
    localStorage.last=today;
    localStorage.point=p;
    point.innerText="ν¬μΈνΈ: "+p;
  }
}

/* ===== λ¨λ“ ===== */
function mode(){
  document.body.classList.toggle("dark");
}

/* ===== λ ===== */
const cv=snow,ctx=cv.getContext("2d");
cv.width=innerWidth;cv.height=innerHeight;
let fl=[];
for(let i=0;i<100;i++)
  fl.push({x:Math.random()*cv.width,y:Math.random()*cv.height,r:Math.random()*3+1});
setInterval(()=>{
  ctx.clearRect(0,0,cv.width,cv.height);
  ctx.fillStyle="white";
  fl.forEach(f=>{
    ctx.beginPath();
    ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
    ctx.fill();
    f.y+=1;if(f.y>cv.height)f.y=0;
  });
},30);
</script>

</body>
</html>

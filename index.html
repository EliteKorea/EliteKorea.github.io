<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê³µë¶€ RPG í”Œë˜ë„ˆ</title>
<style>
*{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%;overflow:hidden;font-family:Arial}
.hidden{display:none}
.center{display:flex;justify-content:center;align-items:center;height:100%}
.box{background:#fff;border-radius:12px;padding:20px;width:320px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
button{padding:6px 10px;margin:4px;cursor:pointer}
input{padding:6px;width:100%;margin:4px 0}

/* ë ˆì´ì•„ì›ƒ */
#mainLayout{display:grid;grid-template-columns:180px 1fr;height:100%}
#left{background:#222;color:#fff;padding:10px}
#right{padding:10px;height:100%;overflow:hidden}
.page{height:100%;overflow:hidden}

/* ë‹¬ë ¥ */
#calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;height:100%}
.day{border:1px solid #aaa;min-height:80px;padding:4px;font-size:12px}
.today{border:2px solid red}

/* íƒ€ì´ë¨¸ */
#timer{width:140px;height:140px;border-radius:50%;border:6px solid #333;display:flex;align-items:center;justify-content:center;margin:10px 0;font-size:20px}
</style>
</head>
<body>

<!-- ë¡œê·¸ì¸ / íšŒì›ê°€ì… -->
<div id="authPage" class="center">
  <div class="box">
    <h2 id="authTitle">ë¡œê·¸ì¸</h2>
    <input id="authId" placeholder="ì•„ì´ë””">
    <input id="authPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button onclick="login()">ë¡œê·¸ì¸</button>
    <button onclick="signup()">íšŒì›ê°€ì…</button>
  </div>
</div>

<!-- ë©”ì¸ -->
<div id="mainPage" class="hidden" style="height:100%">
  <div id="mainLayout">
    <div id="left">
      <h3>ğŸ“Œ ë©”ë‰´</h3>
      <button onclick="showPage('home')">ë©”ì¸</button><br>
      <button onclick="showPage('study')">ê³µë¶€ ì¼ì •</button><br><br>
      <div>
        â­ Lv <span id="level">1</span><br>
        ğŸ· <span id="title"></span><br>
        ğŸ’ <span id="point">0</span>P
      </div>
    </div>
    <div id="right">

      <!-- í™ˆ -->
      <div id="home" class="page">
        <h2>ì˜¤ëŠ˜ì˜ ëª…ì–¸</h2>
        <p id="quote"></p>
        <button onclick="checkIn()">ğŸ“… ì¶œì„ ì²´í¬</button>
        <h3>ì¶œì„ ê¸°ë¡</h3>
        <div id="stampCalendar"></div>
      </div>

      <!-- ê³µë¶€ ì¼ì • -->
      <div id="study" class="page hidden">
        <h2 id="dateTitle"></h2>
        <div style="display:flex;height:100%">
          <div style="width:220px">
            <div id="timer">00:00</div>
            <input id="h" type="number" placeholder="ì‹œ">
            <input id="m" type="number" placeholder="ë¶„">
            <input id="s" type="number" placeholder="ì´ˆ">
            <button onclick="startTimer()">ì‹œì‘</button>
          </div>
          <div style="flex:1;padding-left:10px;height:100%">
            <div id="calendar"></div>
          </div>
        </div>
        <h3>íƒ€ì´ë¨¸ ìŠ¤í‚¨</h3>
        <button onclick="buySkin('default',0)">ê¸°ë³¸</button>
        <button onclick="buySkin('red',10)">ë ˆë“œ</button>
        <button onclick="buySkin('pixel',20)">í”½ì…€</button>
      </div>

    </div>
  </div>
</div>

<script>
/* íšŒì› ì‹œìŠ¤í…œ (localStorage) */
function signup(){
  const id = authId.value.trim();
  const pw = authPw.value.trim();
  if(!id || !pw){ alert('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´'); return; }

  if(localStorage.getItem('user-'+id)){
    alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì•¼');
    return;
  }

  localStorage.setItem('user-'+id, pw);
  alert('íšŒì›ê°€ì… ì™„ë£Œ! ì´ì œ ë¡œê·¸ì¸í•´');
}

function login(){
  const id = authId.value.trim();
  const pw = authPw.value.trim();

  const savedPw = localStorage.getItem('user-'+id);
  if(!savedPw){ alert('ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì•„ì´ë””ì•¼'); return; }
  if(savedPw !== pw){ alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ì–´'); return; }

  localStorage.setItem('login', id);
  authPage.classList.add('hidden');
  mainPage.classList.remove('hidden');
}

/* í˜ì´ì§€ ì „í™˜ */
function showPage(p){
  home.classList.add('hidden');
  study.classList.add('hidden');
  document.getElementById(p).classList.remove('hidden');
}

/* í¬ì¸íŠ¸ / ë ˆë²¨ */
function calcLevel(p){return p>=100?5:p>=50?4:p>=25?3:p>=10?2:1}
function titleByLv(lv){return ['ğŸŒ± ì´ˆë³´','ğŸ”¥ ì§‘ì¤‘ëŸ¬','âš¡ ê¾¸ì¤€ëŸ¬','ğŸ§  ë§ˆìŠ¤í„°','ğŸ‘‘ ì „ì„¤'][lv-1]}
function updateStatus(){
  const p=Number(localStorage.getItem('point')||0);
  point.innerText=p;
  const lv=calcLevel(p);
  level.innerText=lv;
  title.innerText=titleByLv(lv);
}

/* ì¶œì„ */
function checkIn(){
  const d=new Date().toISOString().slice(0,10);
  let data=JSON.parse(localStorage.getItem('att')||'{}');
  if(data[d]) return alert('ì´ë¯¸ ì¶œì„');
  let streak=Number(localStorage.getItem('streak')||0)+1;
  let p=Number(localStorage.getItem('point')||0);
  if(streak===7){p+=10;streak=0;} else p+=1;
  data[d]='âœ”';
  localStorage.setItem('att',JSON.stringify(data));
  localStorage.setItem('streak',streak);
  localStorage.setItem('point',p);
  drawStamp();updateStatus();
}

function drawStamp(){
  let data=JSON.parse(localStorage.getItem('att')||'{}');
  stampCalendar.innerHTML=Object.keys(data).map(d=>'âœ”').join(' ');
}

/* ëª…ì–¸ */
const quotes=['ì˜¤ëŠ˜ì˜ ë…¸ë ¥ì´ ë‚´ì¼ì„ ë§Œë“ ë‹¤','ê¾¸ì¤€í•¨ì´ ì¬ëŠ¥ì´ë‹¤','í¬ê¸°í•˜ì§€ ë§ì'];
quote.innerText=quotes[Math.floor(Math.random()*quotes.length)];

/* ë‹¬ë ¥ ë©”ëª¨ */
function drawCalendar(){
  calendar.innerHTML='';
  const now=new Date();
  dateTitle.innerText=`${now.getFullYear()}ë…„ ${now.getMonth()+1}ì›” ${now.getDate()}ì¼`;
  for(let i=1;i<=31;i++){
    const d=document.createElement('div');
    d.className='day';
    if(i===now.getDate()) d.classList.add('today');
    const key=`memo-${now.getMonth()}-${i}`;
    d.contentEditable=true;
    d.innerText=localStorage.getItem(key)||i;
    d.onblur=()=>localStorage.setItem(key,d.innerText);
    calendar.appendChild(d);
  }
}

/* íƒ€ì´ë¨¸ */
let timerInt;
function startTimer(){
  let t=(+h.value||0)*3600+(+m.value||0)*60+(+s.value||0);
  clearInterval(timerInt);
  timerInt=setInterval(()=>{
    if(t<=0){clearInterval(timerInt);return;}
    t--;
    timer.innerText=Math.floor(t/60)+":"+(t%60).toString().padStart(2,'0');
  },1000);
}

/* íƒ€ì´ë¨¸ ìŠ¤í‚¨ */
function buySkin(s,p){
  let pt=Number(localStorage.getItem('point')||0);
  if(pt<p) return alert('í¬ì¸íŠ¸ ë¶€ì¡±');
  localStorage.setItem('point',pt-p);
  localStorage.setItem('skin',s);
  applySkin();updateStatus();
}
function applySkin(){
  const s=localStorage.getItem('skin');
  timer.style.background='none';timer.style.color='#000';timer.style.borderColor='#333';
  if(s==='red') timer.style.borderColor='red';
  if(s==='pixel'){timer.style.borderColor='#0f0';timer.style.background='#000';timer.style.color='#0f0';}
}

/* ì´ˆê¸° */
if(localStorage.getItem('login')){authPage.classList.add('hidden');mainPage.classList.remove('hidden');}
drawCalendar();drawStamp();updateStatus();applySkin();
</script>
</body>
</html>
